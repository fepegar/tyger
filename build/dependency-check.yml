schedules:
- cron: "0 0 * * *"
  displayName: Daily midnight build
  branches:
    include:
    - main
  always: true

trigger: none
pr: none

pool:
  vmImage: ubuntu-latest

jobs:
- job: CheckDependencies
  displayName: Check dependencies

  steps:
  - checkout: self
    persistCredentials: true

  - task: AzureCLI@2
    displayName: Run tests
    inputs:
      azureSubscription: BiomedicalImaging-NonProd
      scriptType: bash
      scriptLocation: inlineScript
      inlineScript: |
        set -eu
        ./scripts/check-for-dependency-updates.sh --pr
    env:
      AZURE_DEVOPS_EXT_PAT: $(System.AccessToken)
